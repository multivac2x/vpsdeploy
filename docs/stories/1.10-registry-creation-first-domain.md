# Story 1.10: Registry Creation - First Domain

**Epic:** Epic 1 - setup-vps.sh Core Functionality Testing
**Priority:** Must-have

## Description

Verify that running on a fresh VPS creates the initial domains.json registry correctly.

## Acceptance Criteria

- [x] Registry file is created at `/etc/caddy/domains.json` with version 1
- [x] Registry contains `updated_at` timestamp in ISO 8601 format
- [x] Registry contains `domains` object with the new domain entry
- [x] Domain entry includes: `type` (static/dynamic), `added_at`, `updated_at`
- [x] For dynamic domains, entry includes `port` and `app_dir`
- [x] File permissions are 644 (root:root)

## Dependencies

Stories 1.7, 1.8 (actual execution, not dry-run)

## Testing Notes

Requires actual execution on a VPS (not dry-run).

```bash
# After running setup-vps.sh on fresh VPS
ssh deploy@vps "sudo cat /etc/caddy/domains.json" | jq .

# Verify structure
# {
#   "version": 1,
#   "updated_at": "2025-02-17T10:30:00Z",
#   "domains": {
#     "example.com": {
#       "type": "static",
#       "added_at": "2025-02-17T10:00:00Z",
#       "updated_at": "2025-02-17T10:00:00Z"
#     }
#   }
# }

# Check permissions
ssh deploy@vps "ls -l /etc/caddy/domains.json"
# Should show: -rw-r--r-- 1 root root
```
