# Story 2.3: Build Phase - Static Site

**Epic:** Epic 2 - deploy.sh Core Functionality Testing
**Priority:** Must-have

## Description

Verify build process for static Next.js export.

## Acceptance Criteria

- [ ] `package.json` exists in project root
- [ ] `BUILD_CMD` is executed (default: `npm run build`)
- [ ] After build, `BUILD_OUTPUT` directory exists (default: `out/`)
- [ ] Script counts files in output directory and logs count
- [ ] If `BUILD_OUTPUT` missing after build, error and exit code 1
- [ ] If `--skip-build` used, build is skipped and `BUILD_OUTPUT` must already exist

## Dependencies

Story 2.2

## Testing Notes

```bash
# In a Next.js project with static export config
cat > .env.deploy << 'EOF'
VPS_USER=deploy
VPS_IP=your.vps.ip
DOMAIN=example.com
DOMAIN_TYPE=static
EOF

# Test build
./deploy.sh --dry-run 2>&1 | grep "npm run build"

# Test skip-build with existing out/
npm run build  # Create out/
./deploy.sh --skip-build --dry-run
echo $?  # Should be 0

# Test skip-build without out/
rm -rf out/
./deploy.sh --skip-build
echo $?  # Should be 1
```
