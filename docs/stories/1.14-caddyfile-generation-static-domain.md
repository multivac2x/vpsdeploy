# Story 1.14: Caddyfile Generation - Static Domain

**Epic:** Epic 1 - setup-vps.sh Core Functionality Testing
**Priority:** Must-have

## Description

Verify Caddyfile is generated correctly for static domains.

## Acceptance Criteria

- [x] Generated Caddyfile includes `www` redirect block for domain
- [x] Main block uses `root * /var/www/${DOMAIN}`
- [x] Main block includes `file_server` and `try_files` directives
- [x] Per-domain log file at `/var/log/caddy/${DOMAIN}.log`
- [x] Security headers present: X-Content-Type-Options, X-Frame-Options, Referrer-Policy
- [x] Gzip encoding enabled
- [x] Static asset caching headers for CSS/JS/images/fonts

## Dependencies

Story 1.10

## Testing Notes

```bash
# After setup-vps.sh with static domain
ssh deploy@vps "sudo cat /etc/caddy/Caddyfile" | grep -A 20 "example.com"

# Should contain:
# www.example.com {
#     redir https://example.com{uri} permanent
# }
#
# example.com {
#     root * /var/www/example.com
#     file_server
#     try_files {path} {path}.html /index.html
#     log {
#         output file /var/log/caddy/example.com.log
#         format json
#     }
#     @static path *.css *.js *.png *.jpg *.jpeg *.gif *.svg *.woff *.woff2 *.ico
#     header @static Cache-Control "public, max-age=31536000, immutable"
#     header {
#         X-Content-Type-Options "nosniff"
#         X-Frame-Options "DENY"
#         Referrer-Policy "strict-origin-when-cross-origin"
#     }
#     encode gzip
# }
```
