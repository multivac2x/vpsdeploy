# Story 1.27: Idempotency - Repeated Runs

**Epic:** Epic 1 - setup-vps.sh Core Functionality Testing
**Priority:** Must-have

## Description

Verify script can be safely run multiple times with same configuration.

## Acceptance Criteria

- [x] First run completes successfully, creates/updates registry, generates Caddyfile, reloads Caddy
- [x] Second run with identical `.env.deploy`:
  - No errors
  - Registry unchanged (timestamps may update but structure same)
  - Caddyfile identical (diff shows no changes)
  - Caddy not reloaded (or logs "No Caddy config changes")
  - Summary table shows same status
- [x] Third run identical to second

## Dependencies

Stories 1.10-1.18

## Testing Notes

```bash
# First run
./setup-vps.sh > run1.txt 2>&1

# Second run (immediately after)
./setup-vps.sh > run2.txt 2>&1

# Compare
diff run1.txt run2.txt
# Should show only timing differences or "already up to date" messages

# Check Caddyfile unchanged
ssh deploy@vps "sudo cat /etc/caddy/Caddyfile" > caddy1.txt
./setup-vps.sh > /dev/null 2>&1
ssh deploy@vps "sudo cat /etc/caddy/Caddyfile" > caddy2.txt
diff caddy1.txt caddy2.txt
# Should be identical
```
