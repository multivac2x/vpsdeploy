# Story 5.7: DNS Propagation and Domain Addition

**Epic:** Epic 5 - VPS Deployment Scenarios and Operations
**Priority:** Must-have

## Description

Verify workflow when DNS is not yet propagated.

## Acceptance Criteria

- [x] Domain's A record not yet pointing to VPS IP
- [x] Run `setup-vps.sh` → Caddyfile generated, Caddy reloaded
- [x] Run `deploy.sh` → files transferred
- [x] `https://domain` may not work yet (DNS not propagated)
- [x] Once DNS propagates, site works automatically
- [x] Caddy will obtain SSL certificate on first successful HTTPS request
- [x] Document that DNS must propagate before site is accessible

## Dependencies

Stories 3.1, 3.2

## Testing Notes

```bash
# 1. Configure domain with A record pointing elsewhere (or not yet set)
# 2. Run setup-vps.sh
./setup-vps.sh --dry-run
# Should succeed, Caddyfile generated

# 3. Run deploy.sh
./deploy.sh --dry-run
# Should succeed, files would be transferred

# 4. Check Caddy is running but won't obtain SSL yet
ssh deploy@vps "sudo caddy list-certificates"
# Certificate may not exist yet

# 5. Update DNS to point to VPS IP
# Wait for propagation (check with dig or nslookup)

# 6. Once DNS propagates, Caddy automatically obtains SSL
# Test: curl -I https://domain.com
# Should return 200 with valid certificate
```
